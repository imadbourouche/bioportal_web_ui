= turbo_frame_tag 'summary', target:"_top" do
  .summary-page-center.flex-column
    .summary-page-container
      .summary-page-sub-container
        .summary-page-first-row
          = render partial: 'ontologies/sections/metadata/ontology_description_section'
          = render partial: 'ontologies/sections/metadata/ontology_fairness_section'
          = render partial: 'ontologies/sections/metadata/ontology_relations_network'
          = render partial: 'ontologies/sections/metadata/ontology_submissions_section'
          = render partial: 'ontologies/sections/metadata/ontology_metrics_section'
        .summary-page-second-row
          - depiction_url = @submission_latest.depiction
          - unless depiction_url.nil?
            .right_metadata
              .depiction
                %img{src: depiction_url}
                .loop_icon
                  - img = "<img src='#{asset_path("summary/loop.svg")}'/>"
                  = link_to_modal(img.html_safe, "/ajax/submission/show_depiction?depiction_url=#{depiction_url}",data: { show_modal_title_value: "Depiction", show_modal_size_value: 'modal-xl' })

          .right_metadata
            .depiction
              .caintainer_vertical
                .projects_card
                  %p Identifiers
                  %img{src: asset_path("summary/info.svg")}/
              .creation_info
                %p.description_text
                  URI
              %p.normal_text
                = @submission_latest.URI
              .creation_info
                %p.description_text
                  VersionIRI
              %p.normal_text
                = @submission_latest.versionIRI
              .creation_info
                %p.description_text
                  Identifier
              %p.normal_text
                = @submission_latest.identifier
          .right_metadata
            .right_metadata-title-bar{"data-toggle" => "collapse", "data-target" => "#dates_section"}
              %p.fix-margin-buttom
                Dates
              %img{alt: "", src: asset_path("summary/arrow-down.svg")}/
            #dates_section.collapse.right-metadata-conetent
              .creation_info
                %p.description_text
                  Creation date
              %p.normal_text
                = @submission_latest.creationDate
              .creation_info
                %p.description_text
                  Modification date
              %p.normal_text
                = @submission_latest.modificationDate
              .creation_info
                %p.description_text
                  Validity date
              %p.normal_text
                = @submission_latest.valid
          - properties = {creators: @submission_latest.hasCreator, contributors: @submission_latest.hasContributor, curators: @submission_latest.curatedBy,
          translator: @submission_latest.translator, publisher: @submission_latest.publisher,  funded_By: @submission_latest.fundedBy,
          endorsed_By: @submission_latest.endorsedBy, copyright_Holder: @submission_latest.copyrightHolder}
          = render DropdownContainerComponent.new(title: 'Persons and organizations', id: 'person_and_organization') do
            - properties.each do |k, v|
              = render FieldContainerComponent.new(label: k.to_s, value: v)
          .right_metadata
            .right_metadata-title-bar{"data-toggle" => "collapse", "data-target" => "#link_metadata_section"}
              %p.fix-margin-buttom
                Links
              %img{alt: "", src: asset_path("summary/arrow-down.svg")}/
            #link_metadata_section.collapse.right-metadata-content
              %section.ont-metadata-card.ont-links-card
                %div.ont-section-toolbar.justify-content-center.mt-4
                  %a{:href => "#{(@submission_latest || @ontology).id}?display=all", :target => '_blank', :class => "btn btn-primary"} Go to the REST API JSON entry
              .creation_info
                %p.description_text
                  Is Format Of
              %p.normal_text
                = @submission_latest.isFormatOf
              .creation_info
                %p.description_text
                  Has Format
              %p.normal_text
                = @submission_latest.hasFormat
              .creation_info
                %p.description_text
                  Accesss URL
              %p.normal_text
                = @submission_latest.pullLocation
              .creation_info
                %p.description_text
                  Source
              %p.normal_text
                = @submission_latest.source
              .creation_info
                %p.description_text
                  Was generated by
              %p.normal_text
                = @submission_latest.wasGeneratedBy
              .creation_info
                %p.description_text
                  Was invalidated by
              %p.normal_text
                = @submission_latest.wasInvalidatedBy
          .right_metadata
            .right_metadata-title-bar{"data-toggle" => "collapse", "data-target" => "#projects_section"}
              %p.fix-margin-buttom
                Projects and usage information
              %img{alt: "", src: asset_path("summary/arrow-down.svg")}
            #projects_section.collapse.right-metadata-content
              .creation_info
                %div.description_text
                  Projects using
                  = @ontology.acronym
                = link_to(new_project_path(),  "aria-label": "Create new project", title: "Create new project", class: "mx-1 mt-1 projects-add-new") do
                  = inline_svg_tag("summary/plus.svg")
              .projects_container
                - if @projects.empty?
                  %p.font-italic= "No projects using #{@ontology.acronym}"
                - else
                  - for project in @projects
                    = link_to(project_path(project.acronym)) do
                      %p.clickable_text= project.name

              %p.normal_text
                = @submission_latest.isFormatOf
              .creation_info
                %p.description_text
                  known Usage
              %p.normal_text
                = @submission_latest.knownUsage
              .creation_info
                %p.description_text
                  designed For Ontology Task
              %p.normal_text
                = @submission_latest.designedForOntologyTask
              .creation_info
                %p.description_text
                  example
              %p.normal_text
                = @submission_latest.example
              .creation_info
                %p.description_text
                  Coverage
              %p.normal_text
                = @submission_latest.coverage
              .creation_info
                %p.description_text
                  Included In Data Catalog
              %p.normal_text
                = @submission_latest.includedInDataCatalog
              .creation_info
                %p.description_text
                  Target audience
              %p.normal_text
                = @submission_latest.audience
          .right_metadata
            .right_metadata-title-bar{"data-toggle" => "collapse", "data-target" => "#methodology"}
              %p.fix-margin-buttom
                Methodology
              %img{alt: "", src: asset_path("summary/arrow-down.svg")}/
            #methodology.collapse.right-metadata-conetent
              .creation_info
                %p.description_text Accrual method
              %p.normal_text
                = @submission_latest.accrualMethod
              .creation_info
                %p.description_text Accrual periodicity
              %p.normal_text
                = @submission_latest.accrualPeriodicity
              .creation_info
                %p.description_text Accrual policy
              %p.normal_text
                = @submission_latest.accrualPolicy
              .creation_info
                %p.description_text Knowledge representation paradigm
              %p.normal_text
                = @submission_latest.conformsToKnowledgeRepresentationParadigm
              .creation_info
                %p.description_text Engineering methodology
              %p.normal_text
                = @submission_latest.usedOntologyEngineeringMethodology
              .creation_info
                %p.description_text Created With
              %p.normal_text
                = @submission_latest.usedOntologyEngineeringTool
              .creation_info
                %p.description_text Competency question
              %p.normal_text
                = @submission_latest.competencyQuestion
          .right_metadata
            .depiction
              .vists_image
                %p Visits
                - if visits_data(@ontology)
                  = link_to(@ontology.links["analytics"] + "?apikey=#{get_apikey}&format=csv", "aria-label": "Download as CSV", title: "Download as CSV") do
                    %img{alt: "", src: asset_path("summary/arrow_down.svg")}
              = render partial: "visits"
          = render SummarySectionComponent.new(title: 'Get my metadata back')  do
            - unless @submission_latest.nil?
              %div{data:{controller: 'metadata-downloader'}}
                =javascript_include_tag "jsonld"
                %button{:id => "getMetadataBackNquadsBtn", :class => "btn btn-primary", 'data-action': 'metadata-downloader#downloadNQuads'} N-Triple
                %button{:id => "getMetadataBackJsonldBtn", :class => "btn btn-primary", 'data-action': 'metadata-downloader#downloadJsonLd'} Json-LD
                %button{:id => "getMetadataBackXmlBtn", :class => "btn btn-primary", 'data-action': 'metadata-downloader#downloadXML'} RDF/XML
          .Summary-page-card
            - unless @ontology.view?
              %div.ont-section-toolbar
                %header.pb-2.font-weight-bold= "Views of #{@ontology.acronym}"
                - ont_id_esc = CGI.escape(@ontology.id)
                -# TODO: I don't think we should have brackets in the URL parameters.
                - if session[:user].nil?
                  %a{href: "/login?redirect=#{escape("/ontologies/new?ontology[viewOf]=#{ont_id_esc}")}", "aria-label": "Create new view", title: "Create new view"}
                    %i.fas.fa-lg.fa-plus-circle{"aria-hidden": "true", style: "margin-left: 0.5rem;"}
                - else
                  %a{href: "/ontologies/new?ontology[viewOf]=#{ont_id_esc}"}
                    %i.fas.fa-lg.fa-plus-circle{"aria-hidden": "true", style: "margin-left: 0.5rem;"}
              - if @views.empty?
                %p.font-italic= "No views of #{@ontology.acronym} available"
              - else
                %div.border-top
                  %dl
                    - @view_decorators.each do |view_decorator|
                      %dt= view_decorator.linked_name
                      %dd= view_decorator.description